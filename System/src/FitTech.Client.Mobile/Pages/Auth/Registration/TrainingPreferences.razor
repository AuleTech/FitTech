@page "/TrainingPreferences"
@using FitTech.WebComponents.Components.Inputs.Models
@layout EmptyLayout
@attribute [AllowAnonymous]
@inject NavigationManager NavigationManager

<div class="flex flex-col grow bg-fittech-white items-center justify-items-start gap-2 mx-10">
    <div class="pt-[env(safe-area-inset-top)]"></div>
    <h1 class="text-3xl text-fittech-dark font-bold mb-2">Entrenamiento</h1>
    <p class="text-sm text-fittech-dark font-semibold">Ya por ultimo queremos saber tus preferencias a la hora de entrenar. Esto ayudará a tu entrador a adaptar las sesiones lo máximo posible a ti.</p>
    <p class="text-sm text-fittech-dark font-semibold">Estas preferencias las podrás cambiar siempre desde el menú de configuración.</p>
    <br/>
    <EditForm Model="_form" OnValidSubmit="SubmitAsync"
              class="bg-fittech-white flex flex-col w-full gap-6 items-center">
        <DataAnnotationsValidator/>

        <div class="flex flex-col w-full">
            <FitTechNumberInput @bind-Value="_form.AvailableDays" placeholder="Numero de días"
                          Label="¿De cuantos días dispones para entrenar a la semana?"/>
            <ValidationMessage For="@(() => _form!.AvailableDays)" class="text-red-600 text-sm"/>
        </div>
        
        <div class="flex flex-col w-full">
            <FitTechSelect @bind-Value="_form.FavouriteExercises" placeholder="Ejercicios"
                           Label="¿Cuales son tus ejercicios favoritos?" Options="_exercises"/>
            <ValidationMessage For="@(() => _form!.FavouriteExercises)" class="text-red-600 text-sm"/>
        </div>
        
        <div class="flex flex-col w-full">
            <FitTechSelect @bind-Value="_form.Goal" placeholder="Objetivos"
                           Label="¿Cual es tu objetivo?" Options="_goals"/>
            <ValidationMessage For="@(() => _form!.Goal)" class="text-red-600 text-sm"/>
        </div>
        <div class="flex w-full gap-2">
            <div class="flex flex-col items-start w-full">
                <FitTechButton Type="ButtonType.Text" Class="w-[100px] mt-5" Label="Atras"
                               Icon="@HeroiconName.ArrowLeft"  OnClick="@NavigateBack"/>
            </div>
            <div class="flex flex-col items-end w-full">
                <FitTechButton Type="ButtonType.Submit" Class="w-[100px] mt-5" Label="Enviar"
                               Icon="@HeroiconName.PaperAirplane" />
            </div>
        </div>
    </EditForm>
</div>

@code {
    private readonly TrainingPreferencesForm _form = new();
    //TODO: Get options from back
    private readonly FitTechSelectOption[] _exercises = [new ("Sin preferencia"),new ("Pull de Biceps"), new("Press banca")];
    private readonly FitTechSelectOption[] _goals = [new("Musculación"), new("Pérdida de peso"), new("Rehabilitación"), new ("")];
    
    private Task NavigateBack(MouseEventArgs eventArgs)
    {
        NavigationManager.NavigateTo("/BodyMeasures");

        return Task.CompletedTask;
    }
    
    public async Task SubmitAsync()
    {
    }

    private class TrainingPreferencesForm
    {
        [Required(ErrorMessage = "Introduce tu disponibilidad")]
        public int? AvailableDays { get; set; }

        [Required]
        [MinLength(1, ErrorMessage = "Selecciona al menos 1 opción")]
        public string[] FavouriteExercises { get; set; } = [];

        [Required(ErrorMessage = "Selecciona tu objetivo")]
        public string? Goal { get; set; }
    }
}